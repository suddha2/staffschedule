<solver>
    <solutionClass>com.midco.rota.model.Rota</solutionClass>
    <entityClass>com.midco.rota.model.ShiftAssignment</entityClass>
    <environmentMode>FAST_ASSERT</environmentMode>
    
    <scoreDirectorFactory>
        <constraintProviderClass>com.midco.rota.opt.RotaConstraintProvider</constraintProviderClass>
        <constraintMatchEnabled>false</constraintMatchEnabled>
        <indictmentEnabled>false</indictmentEnabled>
    </scoreDirectorFactory>

    <termination>
        <secondsSpentLimit>120</secondsSpentLimit>
        <unimprovedSecondsSpentLimit>60</unimprovedSecondsSpentLimit>
    </termination>

    <bestScoreFeasible>0</bestScoreFeasible>
    <moveThreadCount>AUTO</moveThreadCount>

    <!-- PHASE 1: Permanent employees -->
    <phase>
        <constructionHeuristic>
            <constructionHeuristicType>FIRST_FIT_DECREASING</constructionHeuristicType>
            <entitySorterManner>DECREASING_DIFFICULTY</entitySorterManner>
            <valueSorterManner>DECREASING_STRENGTH</valueSorterManner>
            <valueSelector>
                <variableName>employee</variableName>
                <filterClass>com.midco.rota.opt.PermanentEmployeeFilter</filterClass>
            </valueSelector>
        </constructionHeuristic>
    </phase>

    <!-- PHASE 2: Zero-hours employees -->
    <phase>
        <constructionHeuristic>
            <constructionHeuristicType>FIRST_FIT_DECREASING</constructionHeuristicType>
            <entitySorterManner>DECREASING_DIFFICULTY</entitySorterManner>
            <valueSorterManner>DECREASING_STRENGTH</valueSorterManner>
            <valueSelector>
                <variableName>employee</variableName>
                <filterClass>com.midco.rota.opt.ZeroHoursEmployeeFilter</filterClass>
            </valueSelector>
        </constructionHeuristic>
    </phase>

    <!-- PHASE 3: Simple local search - CHANGE MOVES ONLY -->
    <phase>
        <localSearch>
            <acceptor>
                <entityTabuSize>7</entityTabuSize>
                <lateAcceptanceSize>400</lateAcceptanceSize>
            </acceptor>
            <moveSelector>
                <changeMoveSelector>
                    <entitySelector>
                        <filterClass>com.midco.rota.opt.ZeroHoursAssignmentFilter</filterClass>
                    </entitySelector>
                    <valueSelector>
                        <variableName>employee</variableName>
                        <cacheType>PHASE</cacheType>
                        <selectionOrder>SHUFFLED</selectionOrder>
                    </valueSelector>
                </changeMoveSelector>
            </moveSelector>
        </localSearch>
    </phase>
</solver>